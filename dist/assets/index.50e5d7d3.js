import*as t from"https://unpkg.com/three@0.126.1/build/three.module.js";import{TrackballControls as F}from"https://unpkg.com/three@0.126.1/examples/jsm/controls/TrackballControls.js";import{RGBELoader as H}from"https://unpkg.com/three@0.126.1/examples/jsm/loaders/RGBELoader.js";import{OBJLoader as N}from"https://unpkg.com/three@0.126.1/examples/jsm/loaders/OBJLoader.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerpolicy&&(a.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?a.credentials="include":n.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}})();let G,V,w,i,d;const u=8;let x=[];const l=new t.Group,h={shadows:{shadowsEnable:!1},lights:{spotLightTargetX:4,spotLightTargetY:10,spotLightTargetZ:4,spotLightIntensity:3,spotLightAngle:Math.PI/12},scene:{rotationEnable:!1},renderer:{exposure:.1}};W();S();function W(){w=new t.Scene;const e=new t.CylinderGeometry(u*.35,u*.35,u*10,24),s=new t.MeshPhongMaterial({color:0}),r=new t.Mesh(e,s);r.translateY(-u*5.04),w.add(r),G=new t.PerspectiveCamera(75,innerWidth/innerHeight,.1,1e3),G.position.z=5,i=new t.WebGLRenderer({antialias:!0}),i.setPixelRatio(window.devicePixelRatio),i.setSize(window.innerWidth,window.innerHeight),i.shadowMap.enabled=!0,i.shadowMap.type=t.PCFSoftShadowMap,document.body.appendChild(i.domElement),i.toneMapping=t.ReinhardToneMapping,i.toneMappingExposure=h.renderer.exposure,i.outputEncoding=t.sRGBEncoding,new H().load("./old_hall_2k.hdr",function(o){o.mapping=t.EquirectangularReflectionMapping,w.background=o,w.environment=o}),V=new F(G,i.domElement),V.rotateSpeed=1,V.zoomSpeed=1.2,V.panSpeed=.8,V.keys=["KeyA","KeyS","KeyD"],D(),_(u),Y(u),console.log(l),w.add(l)}function S(){requestAnimationFrame(S),V.update(),i.render(w,G)}function Y(e){const s=e/8,r=e/16;for(let o=0;o<8;o++)O(e/26,16777215,-e/2+o*s+r,s*2+r);for(let o=0;o<8;o++)O(e/26,0,-e/2+o*s+r,-s*3+r);I(e*.05,16777215,-s+r,s*3+r),I(e*.05,0,0+r,-s*4+r),L(e/23,0,-e/2+r,-e/2+r),L(e/23,0,e/2-r,-e/2+r),L(e/23,16777215,-e/2+r,e/2-r),L(e/23,16777215,e/2-r,e/2-r)}function O(e,s,r,o){const n=new t.MeshPhysicalMaterial({color:s,metalness:0,roughness:.5,clearcoat:0,clearcoatRoughness:.3,reflectivity:.5,transmission:.9}),a=new t.BoxGeometry(e*1.7,e*.1,e*1.7);a.translate(r,0,o);const c=new t.BoxGeometry(e*1.3,e*.8,e*1.3);c.translate(r,e*.4,o);const g=new t.BoxGeometry(e*1.4,e*.1,e*1.4);g.translate(r,e*.8,o);const y=new t.BoxGeometry(e*1,e*.7,e*1);y.translate(r,e*1.2,o);const m=new t.BoxGeometry(e*1.1,e*.1,e*1.1);m.translate(r,e*1.6,o);const M=new t.BoxGeometry(e*.6,e*1.1,e*.6);M.translate(r,e*2.2,o);const p=new t.BoxGeometry(e*.7,e*.1,e*.7);p.translate(r,e*2.7,o);const f=new t.BoxGeometry(e*.2,e*.4,e*.2);f.translate(r,e*2.9,o);const E=new t.BoxGeometry(e*.9,e*.8,e*.9);E.translate(r,e*3.2,o);const b=new t.Mesh(a,n);b.castShadow=h.shadows.shadowsEnable;const B=new t.Mesh(c,n);B.castShadow=h.shadows.shadowsEnable;const P=new t.Mesh(g,n);P.castShadow=h.shadows.shadowsEnable;const R=new t.Mesh(y,n);R.castShadow=h.shadows.shadowsEnable;const k=new t.Mesh(m,n);k.castShadow=h.shadows.shadowsEnable;const T=new t.Mesh(M,n);T.castShadow=h.shadows.shadowsEnable;const q=new t.Mesh(p,n);q.castShadow=h.shadows.shadowsEnable;const A=new t.Mesh(f,n);A.castShadow=h.shadows.shadowsEnable;const C=new t.Mesh(E,n);C.castShadow=h.shadows.shadowsEnable,l.add(b),l.add(B),l.add(P),l.add(R),l.add(k),l.add(T),l.add(q),l.add(A),l.add(C)}function I(e,s,r,o){const n=[];n.push(new t.Vector2(0,0)),n.push(new t.Vector2(1,0)),n.push(new t.Vector2(1.05,.072)),n.push(new t.Vector2(.946,.159)),n.push(new t.Vector2(.997,.204)),n.push(new t.Vector2(.885,.296)),n.push(new t.Vector2(1,.468)),n.push(new t.Vector2(.93,.6)),n.push(new t.Vector2(.67,.71)),n.push(new t.Vector2(.78,.79)),n.push(new t.Vector2(.688,.872)),n.push(new t.Vector2(.638,.852)),n.push(new t.Vector2(.43,1.43)),n.push(new t.Vector2(.34,2.12)),n.push(new t.Vector2(.334,2.67)),n.push(new t.Vector2(.54,2.67)),n.push(new t.Vector2(.643,2.81)),n.push(new t.Vector2(.496,2.9)),n.push(new t.Vector2(.5,2.96)),n.push(new t.Vector2(.41,3)),n.push(new t.Vector2(.445,3.06)),n.push(new t.Vector2(.324,3.12)),n.push(new t.Vector2(.4,3.36)),n.push(new t.Vector2(.55,3.63)),n.push(new t.Vector2(.612,3.79)),n.push(new t.Vector2(.506,3.78)),n.push(new t.Vector2(.273,3.88)),n.push(new t.Vector2(.208,3.93)),n.push(new t.Vector2(.263,4)),n.push(new t.Vector2(.172,4.08)),n.push(new t.Vector2(0,4.085));const a=new t.LatheGeometry(n,24),c=new t.MeshPhysicalMaterial({color:s,metalness:.3,roughness:.8,clearcoat:1,clearcoatRoughness:.1,reflectivity:.7,transmission:0}),g=new t.BoxGeometry(.2,.7,.1),y=new t.BoxGeometry(.5,.2,.1);g.translate(0,4.3,0),y.translate(0,4.3,0),g.scale(e,e,e),y.scale(e,e,e);const m=new t.Mesh(g,c),M=new t.Mesh(y,c);m.translateX(r),m.translateZ(o),M.translateX(r),M.translateZ(o);const p=new t.Mesh(a,c);p.scale.set(e,e,e),p.translateX(r),p.translateZ(o);const f=new t.Group;f.add(m),f.add(M),f.add(p),l.add(f)}function L(e,s,r,o){const n=new N,a=new t.MeshPhysicalMaterial({color:s,metalness:.3,roughness:.8,clearcoat:1,clearcoatRoughness:.1,reflectivity:.7,transmission:0});n.load("rook.obj",function(c){c.children[0].material=a,c.children[0].translateX(r),c.children[0].translateZ(o),c.children[0].geometry.scale(e,e,e),l.add(c.children[0])})}function _(e){const s=new t.MeshPhysicalMaterial({color:16777215,metalness:0,roughness:.9,clearcoat:.7,clearcoatRoughness:.8,reflectivity:.15,transmission:0}),r=new t.MeshPhysicalMaterial({color:2955786,metalness:0,roughness:.9,clearcoat:.7,clearcoatRoughness:.8,reflectivity:.15,transmission:0}),o=e/8;for(let n=0;n<8;n++)for(let a=0;a<8;a++)(n+a)%2==0?K(o,o*n-e/2+o/2,-e*.02,o*a-e/2+o/2,s):K(o,o*n-e/2+o/2,-e*.02,o*a-e/2+o/2,r)}function K(e,s,r,o,n){const a=new t.BoxGeometry(e,e*.3,e);a.translate(s,r,o);const c=new t.Mesh(a,n);c.receiveShadow=!0,l.add(c)}function D(){x.forEach(function(s){w.remove(s)}),x=[],d=new t.SpotLight(5592405,h.lights.spotLightIntensity),d.castShadow=!0,d.angle=h.lights.spotLightAngle,d.penumbra=1,d.decay=2,d.distance=50,d.position.set(-u/2,u/4,-u/2),w.add(d),w.add(d.target),d.target.position.set(h.lights.spotLightTargetX,h.lights.spotLightTargetY,h.lights.spotLightTargetZ),x.push(d);const e=new t.AmbientLight(2105376);w.add(e),x.push(e)}
